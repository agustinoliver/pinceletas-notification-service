package ar.edu.utn.frc.tup.tesis.pinceletas_notification_service.clients;

import ar.edu.utn.frc.tup.tesis.pinceletas_notification_service.clients.UserServiceClient;
import lombok.RequiredArgsConstructor;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class UserMappingService {

    private static final Logger log = LoggerFactory.getLogger(UserMappingService.class);

    private final UserServiceClient userServiceClient;

    public Long obtenerUserIdPorEmail(String email) {
        try {
            log.info("üîç Buscando userId para email: {}", email);

            UserServiceClient.UserBasicInfo user = userServiceClient.getUserByEmail(email);

            if (user != null && user.id() != null) {
                log.info("‚úÖ userId encontrado: {} para email: {}", user.id(), email);
                return user.id();
            } else {
                log.warn("‚ö†Ô∏è Usuario no encontrado para email: {}", email);
                return null;
            }
        } catch (Exception e) {
            log.error("‚ùå Error obteniendo userId para email {}: {}", email, e.getMessage());
            return null;
        }
    }
}
